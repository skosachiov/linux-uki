#!/usr/bin/make -f

package := linux-uki

# You must remove unused comment lines for the released package.
export DH_VERBOSE = 1
#export DEB_BUILD_MAINT_OPTIONS = hardening=+all
#export DEB_CFLAGS_MAINT_APPEND  = -Wall -pedantic
#export DEB_LDFLAGS_MAINT_APPEND = -Wl,-O1

export KERNEL_VERSION = $(shell basename /boot/vmlinuz-* | sed 's/vmlinuz-//')

ifeq ($(DEB_HOST_ARCH),amd64)
	export SB_PACKAGE = linux-uki
	export SB_PLATFORM = x86_64-efi
	export SB_EFI_NAME = x64
endif
ifeq ($(DEB_HOST_ARCH),arm64)
	export SB_PACKAGE = linux-uki
	export SB_PLATFORM = arm64-efi
	export SB_EFI_NAME = aa64
endif

%:
	dh $@

#override_dh_auto_install:
#	dh_auto_install -- prefix=/usr

#override_dh_install:
#	dh_install --list-missing -X.pyc -X.pyo

override_dh_auto_install:
	./debian/signing-template.generate "$(package)"
